import{u as v,ac as g,j as P,w as S}from"./eDSVRnne.js";const _=(e,r,t,i,a)=>{let n=[];return t&&(t==null||t.map(s=>{if(s.selectedPrice._id===r.selectedPrice._id)if(e==="sub"){if(s.quantity===1||a===0)return;s.quantity=a||s.quantity-1}else s.quantity=a||s.quantity+1;n.push(s)})),S(`cart_details_${i}`,JSON.stringify({products:n})),n},I=e=>{if(!e.length)return 0;let r=0;return e.forEach(t=>{r+=w(t)*t.quantity}),r},R=e=>(e==null?void 0:e.availableQuantity)<=0&&e.trackInventory&&!e.allowOutOfStockPurchases,A=async e=>{const r=v();try{const{data:t}=await g.getAllCollectionsByLocation({altId:r.value.locationId,altType:"location",collectionIds:e.join()});return t}catch(t){console.error("Error caught: ",t.message)}},j=(e,r)=>{var t;return(t=e==null?void 0:e.medias)==null?void 0:t.find(i=>{var a;return(a=i==null?void 0:i.priceIds)==null?void 0:a.includes(r)})},q=e=>e.filter(r=>r.selectedPrice.type==="recurring").length>1,w=e=>{let r=e.selectedPrice.amount;return e.selectedPrice.trialPeriod&&(r=0),r+(e.selectedPrice.setupFee??0)},F=async(e,r)=>{let t=e==null?void 0:e.map(a=>{var n;return(n=a==null?void 0:a.selectedPrice)==null?void 0:n._id}).join(",");const i=await g.getSelectedProductPrices({locationId:r,ids:t});return e==null||e.map(a=>{const n=i.find(s=>s._id===a.selectedPrice._id);return a.quantity>n.availableQuantity&&n.trackInventory&&!n.allowOutOfStockPurchases?(a.status=`Only ${n.availableQuantity} items are available in stock`,a.isDeleted=!0,a):n?(a.status="",a.isDeleted=!1,a.name=n.product.name,a.selectedProductImage=a.selectedProductImage??n.product.image,a.selectedPrice.name=n.name,a.selectedPrice.amount=n.amount,a.selectedPrice.currency=n.currency,a):(a.status="W're sorry! This item is not available at the moment",a.isDeleted=!0,a)}),e},L=e=>e.map(t=>t.isDeleted).includes(!0),T=e=>`${((e.compareAtPrice-e.amount)*100/e.compareAtPrice).toFixed(0)}% off`,C=e=>e.carrierRateId?e.carrierRateId:e._id,E=async(e,r,t,i,a,n,s,o,c,u,f)=>{const d=v(),l={limit:e,offset:r,locationId:d.value.locationId,collectionSlug:t,storeId:d.value.funnelId};i&&(l.q=encodeURIComponent(i)),a&&(l.advancedSearch=a),n&&(l.availability=n),s&&(l.minPrice=s),o&&(l.maxPrice=o),c&&(l.sortField=c),u&&(l.sortOrder=u),f&&(l.productIds=f.join(","));try{return await g.getStoreProducts(l)}catch(y){console.error("Error while fetching products: ",y)}},Q=e=>{var r,t,i,a,n;if(e.isLabelEnabled&&((r=e.label)!=null&&r.title)){let s=!0;return(t=e.label)!=null&&t.startDate&&(s=P().isAfter(P((i=e.label)==null?void 0:i.startDate))),(a=e.label)!=null&&a.endDate&&(s=s&&P().isBefore(P((n=e.label)==null?void 0:n.endDate))),s}},U=(e,r,t)=>{var i,a,n,s,o,c,u,f,d,l,y;return(i=e==null?void 0:e.cartDetails)==null||i.products.push(r),e.total+=(n=(a=t.value)==null?void 0:a.order)==null?void 0:n.amount,e.taxDetails=(c=(o=(s=t.value)==null?void 0:s.order)==null?void 0:o.taxSummary)==null?void 0:c.map(h=>{var b;const m=(b=e==null?void 0:e.taxDetails)==null?void 0:b.find(O=>O._id===h._id);return m?{...m,amount:m.amount+h.amount}:h}),e.shippingRate?e.shippingRate.amount+=((d=(f=(u=t.value)==null?void 0:u.order)==null?void 0:f.shippingRate)==null?void 0:d.amount)??0:e.shippingRate=(y=(l=t.value)==null?void 0:l.order)==null?void 0:y.shippingRate,e},B=(e,r,t)=>{var i;if(!e)return"";try{const a=(i=window.libphonenumber)==null?void 0:i.parsePhoneNumberFromString(e,r);return a&&a.isValid()?t?a.formatInternational():a.formatNational():e}catch{return e}};export{T as a,w as b,F as c,R as d,j as e,E as f,A as g,q as h,L as i,I as j,B as k,C as l,U as m,Q as s,_ as u};
